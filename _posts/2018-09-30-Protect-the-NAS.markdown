---
layout:     post
title:      "保护好群晖的数据"
subtitle:   "记一次设置数据损毁经历"
date:       2018-09-30
author:     "SunnyRx"
header-img: "img/post-bg-nas.jpg"
tags:
    - NAS
    - 群晖
---

在笔者很繁忙的这个月，有一天睡醒发现NAS连不上去了，登上去一看提示**设置数据损毁**，需要重装DSM系统，差点被气死……但考虑到笔者在用的是黑群晖，没资格生气，到底群晖还是一个很优秀的NAS系统。

在网上搜了一下，发现有很多人都遇到这样的事，而且不管是黑群晖还是白群晖都有遇到，但是原因不明。*如果有人知道的话希望能在评论中留言。*

# 重装系统

遇到这样的情况，基本上是没救了，老实重装DSM系统吧。*如果有人知道其它解决方法，希望能在评论中留言。*

> 其实早在2016年时，笔者就已经经历过一次这样的经历了，但是已经记不清自己怎么处理的了，只记得是数据拷贝走了，然后重装了系统，然后数据是搬回去还是没有被格式化就记不清了。

重点来了！重装系统前记得**先把硬盘中的资料拷贝走！**

笔者这次就是抱着侥幸心理，直接重装了DSM系统，开始重装才发现有一步是格式化硬盘，发现的时候已经晚了。好在笔者最重要的数据储存在外置硬盘，尽管如此一些网站数据丢了也是好可惜，而且好多东西要自己重头安装，非常费时间。

是的，重装后就一切重头来过吧，如果之前有备份配置文件的话，还原配置文件可以节省一丁点儿时间。

# 备份数据

趁这次重头搭建一个NAS，笔者在思考为了避免以后不要再发生这种悲剧，能提前做些什么工作。

目前笔者思考到的解决方案（针对黑群辉）有以下：

### 利用Cloud Sync将储存数据加密后备份到百度云网盘

这个方法只能备份一部分数据。

把储存的数据都上传到另一个服务器的话，应该就不怕了吧。笔者是这么想的，群晖的Cloud Sync套件中可以把储存的内容上传到云服务器，考虑到所有支持的服务器中，唯一能用而且空间够大的，也就只有百度云了……尽管信不过百度云，也没办法了，至少Cloud Sync支持加密后上传，可以稍微安心一点点。

但是缺点也是明显的，选择备份的文件夹只可以是根目录中的其中一个。再添加一个文件夹会提示“您已连接到此公共云账户，要创建子任务，请进入‘任务’列表选项卡并单击‘创建’。”

### 利用群晖自带的备份和复制功能，备份到rsync兼容服务器

![利用群晖自带的备份和复制功能，被分到rsync兼容服务器](\img\in-post\post-NAS\Snipaste_2018-09-30_20-58-51.jpg)

rsync是朋友[小强](https://ruterly.com/)推荐的方法，问题是笔者没有一个足够大的服务器备份整个NAS。

### 利用群晖自带的备份和复制功能，备份到外置硬盘

嗯，虽然很蠢，但是当下笔者想不到其它更好的办法了。


利用Cloud Sync是肯定不会备份系统文件，但是群晖自带的备份和复制功能还不确定会不会备份系统文件。其实备份和复制功能也可以备份到云服务，但是支持的服务器列表有点少。

# 总结

如果遇到**设置数据损毁**，重装系统前记得**先把硬盘中的资料拷贝走**。

为了保护群晖中的数据，提前做好备份，可以考虑使用Cloud Sync或者备份和复制功能。